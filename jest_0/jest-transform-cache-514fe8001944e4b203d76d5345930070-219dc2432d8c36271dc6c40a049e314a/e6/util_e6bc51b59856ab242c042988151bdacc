7ebc73efd2f88d2dd9e3b5e7c68d1e51
'use strict';(function ($) {

	/**
                             * Generate an indented list of links from a nav. Meant for use with panel().
                             * @return {jQuery} jQuery object.
                             */
	$.fn.navList = function () {

		var $this = $(this);
		$a = $this.find('a'),
		b = [];

		$a.each(function () {

			var $this = $(this),
			indent = Math.max(0, $this.parents('li').length - 1),
			href = $this.attr('href'),
			target = $this.attr('target');

			b.push(
			'<a ' +
			'class="link depth-' + indent + '"' + (
			typeof target !== 'undefined' && target != '' ? ' target="' + target + '"' : '') + (
			typeof href !== 'undefined' && href != '' ? ' href="' + href + '"' : '') +
			'>' +
			'<span class="indent-' + indent + '"></span>' +
			$this.text() +
			'</a>');


		});

		return b.join('');

	};

	/**
     * Panel-ify an element.
     * @param {object} userConfig User config.
     * @return {jQuery} jQuery object.
     */
	$.fn.panel = function (userConfig) {

		// No elements?
		if (this.length == 0)
		return $this;

		// Multiple elements?
		if (this.length > 1) {

			for (var i = 0; i < this.length; i++) {
				$(this[i]).panel(userConfig);}

			return $this;

		}

		// Vars.
		var $this = $(this),
		$body = $('body'),
		$window = $(window),
		id = $this.attr('id'),
		config;

		// Config.
		config = $.extend({

			// Delay.
			delay: 0,

			// Hide panel on link click.
			hideOnClick: false,

			// Hide panel on escape keypress.
			hideOnEscape: false,

			// Hide panel on swipe.
			hideOnSwipe: false,

			// Reset scroll position on hide.
			resetScroll: false,

			// Reset forms on hide.
			resetForms: false,

			// Side of viewport the panel will appear.
			side: null,

			// Target element for "class".
			target: $this,

			// Class to toggle.
			visibleClass: 'visible' },

		userConfig);

		// Expand "target" if it's not a jQuery object already.
		if (typeof config.target != 'jQuery')
		config.target = $(config.target);

		// Panel.

		// Methods.
		$this._hide = function (event) {

			// Already hidden? Bail.
			if (!config.target.hasClass(config.visibleClass))
			return;

			// If an event was provided, cancel it.
			if (event) {

				event.preventDefault();
				event.stopPropagation();

			}

			// Hide.
			config.target.removeClass(config.visibleClass);

			// Post-hide stuff.
			window.setTimeout(function () {

				// Reset scroll position.
				if (config.resetScroll)
				$this.scrollTop(0);

				// Reset forms.
				if (config.resetForms)
				$this.find('form').each(function () {
					this.reset();
				});

			}, config.delay);

		};

		// Vendor fixes.
		$this.
		css('-ms-overflow-style', '-ms-autohiding-scrollbar').
		css('-webkit-overflow-scrolling', 'touch');

		// Hide on click.
		if (config.hideOnClick) {

			$this.find('a').
			css('-webkit-tap-highlight-color', 'rgba(0,0,0,0)');

			$this.
			on('click', 'a', function (event) {

				var $a = $(this),
				href = $a.attr('href'),
				target = $a.attr('target');

				if (!href || href == '#' || href == '' || href == '#' + id)
				return;

				// Cancel original event.
				event.preventDefault();
				event.stopPropagation();

				// Hide panel.
				$this._hide();

				// Redirect to href.
				window.setTimeout(function () {

					if (target == '_blank')
					window.open(href);else

					window.location.href = href;

				}, config.delay + 10);

			});

		}

		// Event: Touch stuff.
		$this.on('touchstart', function (event) {

			$this.touchPosX = event.originalEvent.touches[0].pageX;
			$this.touchPosY = event.originalEvent.touches[0].pageY;

		});

		$this.on('touchmove', function (event) {

			if ($this.touchPosX === null ||
			$this.touchPosY === null)
			return;

			var diffX = $this.touchPosX - event.originalEvent.touches[0].pageX,
			diffY = $this.touchPosY - event.originalEvent.touches[0].pageY,
			th = $this.outerHeight(),
			ts = $this.get(0).scrollHeight - $this.scrollTop();

			// Hide on swipe?
			if (config.hideOnSwipe) {

				var result = false,
				boundary = 20,
				delta = 50;

				switch (config.side) {

					case 'left':
						result = diffY < boundary && diffY > -1 * boundary && diffX > delta;
						break;

					case 'right':
						result = diffY < boundary && diffY > -1 * boundary && diffX < -1 * delta;
						break;

					case 'top':
						result = diffX < boundary && diffX > -1 * boundary && diffY > delta;
						break;

					case 'bottom':
						result = diffX < boundary && diffX > -1 * boundary && diffY < -1 * delta;
						break;

					default:
						break;}



				if (result) {

					$this.touchPosX = null;
					$this.touchPosY = null;
					$this._hide();

					return false;

				}

			}

			// Prevent vertical scrolling past the top or bottom.
			if ($this.scrollTop() < 0 && diffY < 0 ||
			ts > th - 2 && ts < th + 2 && diffY > 0) {

				event.preventDefault();
				event.stopPropagation();

			}

		});

		// Event: Prevent certain events inside the panel from bubbling.
		$this.on('click touchend touchstart touchmove', function (event) {
			event.stopPropagation();
		});

		// Event: Hide panel if a child anchor tag pointing to its ID is clicked.
		$this.on('click', 'a[href="#' + id + '"]', function (event) {

			event.preventDefault();
			event.stopPropagation();

			config.target.removeClass(config.visibleClass);

		});

		// Body.

		// Event: Hide panel on body click/tap.
		$body.on('click touchend', function (event) {
			$this._hide(event);
		});

		// Event: Toggle.
		$body.on('click', 'a[href="#' + id + '"]', function (event) {

			event.preventDefault();
			event.stopPropagation();

			config.target.toggleClass(config.visibleClass);

		});

		// Window.

		// Event: Hide on ESC.
		if (config.hideOnEscape)
		$window.on('keydown', function (event) {

			if (event.keyCode == 27)
			$this._hide(event);

		});

		return $this;

	};

	/**
     * Apply "placeholder" attribute polyfill to one or more forms.
     * @return {jQuery} jQuery object.
     */
	$.fn.placeholder = function () {

		// Browser natively supports placeholders? Bail.
		if (typeof document.createElement('input').placeholder != 'undefined')
		return $(this);

		// No elements?
		if (this.length == 0)
		return $this;

		// Multiple elements?
		if (this.length > 1) {

			for (var i = 0; i < this.length; i++) {
				$(this[i]).placeholder();}

			return $this;

		}

		// Vars.
		var $this = $(this);

		// Text, TextArea.
		$this.find('input[type=text],textarea').
		each(function () {

			var i = $(this);

			if (i.val() == '' ||
			i.val() == i.attr('placeholder'))
			i.
			addClass('polyfill-placeholder').
			val(i.attr('placeholder'));

		}).
		on('blur', function () {

			var i = $(this);

			if (i.attr('name').match(/-polyfill-field$/))
			return;

			if (i.val() == '')
			i.
			addClass('polyfill-placeholder').
			val(i.attr('placeholder'));

		}).
		on('focus', function () {

			var i = $(this);

			if (i.attr('name').match(/-polyfill-field$/))
			return;

			if (i.val() == i.attr('placeholder'))
			i.
			removeClass('polyfill-placeholder').
			val('');

		});

		// Password.
		$this.find('input[type=password]').
		each(function () {

			var i = $(this);
			var x = $(
			$('<div>').
			append(i.clone()).
			remove().
			html().
			replace(/type="password"/i, 'type="text"').
			replace(/type=password/i, 'type=text'));


			if (i.attr('id') != '')
			x.attr('id', i.attr('id') + '-polyfill-field');

			if (i.attr('name') != '')
			x.attr('name', i.attr('name') + '-polyfill-field');

			x.addClass('polyfill-placeholder').
			val(x.attr('placeholder')).insertAfter(i);

			if (i.val() == '')
			i.hide();else

			x.hide();

			i.
			on('blur', function (event) {

				event.preventDefault();

				var x = i.parent().find('input[name=' + i.attr('name') + '-polyfill-field]');

				if (i.val() == '') {

					i.hide();
					x.show();

				}

			});

			x.
			on('focus', function (event) {

				event.preventDefault();

				var i = x.parent().find('input[name=' + x.attr('name').replace('-polyfill-field', '') + ']');

				x.hide();

				i.
				show().
				focus();

			}).
			on('keypress', function (event) {

				event.preventDefault();
				x.val('');

			});

		});

		// Events.
		$this.
		on('submit', function () {

			$this.find('input[type=text],input[type=password],textarea').
			each(function (event) {

				var i = $(this);

				if (i.attr('name').match(/-polyfill-field$/))
				i.attr('name', '');

				if (i.val() == i.attr('placeholder')) {

					i.removeClass('polyfill-placeholder');
					i.val('');

				}

			});

		}).
		on('reset', function (event) {

			event.preventDefault();

			$this.find('select').
			val($('option:first').val());

			$this.find('input,textarea').
			each(function () {

				var i = $(this),
				x;

				i.removeClass('polyfill-placeholder');

				switch (this.type) {

					case 'submit':
					case 'reset':
						break;

					case 'password':
						i.val(i.attr('defaultValue'));

						x = i.parent().find('input[name=' + i.attr('name') + '-polyfill-field]');

						if (i.val() == '') {
							i.hide();
							x.show();
						} else
						{
							i.show();
							x.hide();
						}

						break;

					case 'checkbox':
					case 'radio':
						i.attr('checked', i.attr('defaultValue'));
						break;

					case 'text':
					case 'textarea':
						i.val(i.attr('defaultValue'));

						if (i.val() == '') {
							i.addClass('polyfill-placeholder');
							i.val(i.attr('placeholder'));
						}

						break;

					default:
						i.val(i.attr('defaultValue'));
						break;}


			});

		});

		return $this;

	};

	/**
     * Moves elements to/from the first positions of their respective parents.
     * @param {jQuery} $elements Elements (or selector) to move.
     * @param {bool} condition If true, moves elements to the top. Otherwise, moves elements back to their original locations.
     */
	$.prioritize = function ($elements, condition) {

		var key = '__prioritize';

		// Expand $elements if it's not already a jQuery object.
		if (typeof $elements != 'jQuery')
		$elements = $($elements);

		// Step through elements.
		$elements.each(function () {

			var $e = $(this),$p,
			$parent = $e.parent();

			// No parent? Bail.
			if ($parent.length == 0)
			return;

			// Not moved? Move it.
			if (!$e.data(key)) {

				// Condition is false? Bail.
				if (!condition)
				return;

				// Get placeholder (which will serve as our point of reference for when this element needs to move back).
				$p = $e.prev();

				// Couldn't find anything? Means this element's already at the top, so bail.
				if ($p.length == 0)
				return;

				// Move element to top of parent.
				$e.prependTo($parent);

				// Mark element as moved.
				$e.data(key, $p);

			}

			// Moved already?
			else {

					// Condition is true? Bail.
					if (condition)
					return;

					$p = $e.data(key);

					// Move element back to its original location (using our placeholder).
					$e.insertAfter($p);

					// Unmark element as moved.
					$e.removeData(key);

				}

		});

	};

})(jQuery);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWwuanMiXSwibmFtZXMiOlsiJCIsImZuIiwibmF2TGlzdCIsIiR0aGlzIiwiJGEiLCJmaW5kIiwiYiIsImVhY2giLCJpbmRlbnQiLCJNYXRoIiwibWF4IiwicGFyZW50cyIsImxlbmd0aCIsImhyZWYiLCJhdHRyIiwidGFyZ2V0IiwicHVzaCIsInRleHQiLCJqb2luIiwicGFuZWwiLCJ1c2VyQ29uZmlnIiwiaSIsIiRib2R5IiwiJHdpbmRvdyIsIndpbmRvdyIsImlkIiwiY29uZmlnIiwiZXh0ZW5kIiwiZGVsYXkiLCJoaWRlT25DbGljayIsImhpZGVPbkVzY2FwZSIsImhpZGVPblN3aXBlIiwicmVzZXRTY3JvbGwiLCJyZXNldEZvcm1zIiwic2lkZSIsInZpc2libGVDbGFzcyIsIl9oaWRlIiwiZXZlbnQiLCJoYXNDbGFzcyIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwicmVtb3ZlQ2xhc3MiLCJzZXRUaW1lb3V0Iiwic2Nyb2xsVG9wIiwicmVzZXQiLCJjc3MiLCJvbiIsIm9wZW4iLCJsb2NhdGlvbiIsInRvdWNoUG9zWCIsIm9yaWdpbmFsRXZlbnQiLCJ0b3VjaGVzIiwicGFnZVgiLCJ0b3VjaFBvc1kiLCJwYWdlWSIsImRpZmZYIiwiZGlmZlkiLCJ0aCIsIm91dGVySGVpZ2h0IiwidHMiLCJnZXQiLCJzY3JvbGxIZWlnaHQiLCJyZXN1bHQiLCJib3VuZGFyeSIsImRlbHRhIiwidG9nZ2xlQ2xhc3MiLCJrZXlDb2RlIiwicGxhY2Vob2xkZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ2YWwiLCJhZGRDbGFzcyIsIm1hdGNoIiwieCIsImFwcGVuZCIsImNsb25lIiwicmVtb3ZlIiwiaHRtbCIsInJlcGxhY2UiLCJpbnNlcnRBZnRlciIsImhpZGUiLCJwYXJlbnQiLCJzaG93IiwiZm9jdXMiLCJ0eXBlIiwicHJpb3JpdGl6ZSIsIiRlbGVtZW50cyIsImNvbmRpdGlvbiIsImtleSIsIiRlIiwiJHAiLCIkcGFyZW50Iiwi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ZmlsZSI6InV0aWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCkge1xyXG5cclxuXHQvKipcclxuXHQgKiBHZW5lcmF0ZSBhbiBpbmRlbnRlZCBsaXN0IG9mIGxpbmtzIGZyb20gYSBuYXYuIE1lYW50IGZvciB1c2Ugd2l0aCBwYW5lbCgpLlxyXG5cdCAqIEByZXR1cm4ge2pRdWVyeX0galF1ZXJ5IG9iamVjdC5cclxuXHQgKi9cclxuXHQkLmZuLm5hdkxpc3QgPSBmdW5jdGlvbigpIHtcclxuXHJcblx0XHR2YXJcdCR0aGlzID0gJCh0aGlzKTtcclxuXHRcdFx0JGEgPSAkdGhpcy5maW5kKCdhJyksXHJcblx0XHRcdGIgPSBbXTtcclxuXHJcblx0XHQkYS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdFx0dmFyXHQkdGhpcyA9ICQodGhpcyksXHJcblx0XHRcdFx0aW5kZW50ID0gTWF0aC5tYXgoMCwgJHRoaXMucGFyZW50cygnbGknKS5sZW5ndGggLSAxKSxcclxuXHRcdFx0XHRocmVmID0gJHRoaXMuYXR0cignaHJlZicpLFxyXG5cdFx0XHRcdHRhcmdldCA9ICR0aGlzLmF0dHIoJ3RhcmdldCcpO1xyXG5cclxuXHRcdFx0Yi5wdXNoKFxyXG5cdFx0XHRcdCc8YSAnICtcclxuXHRcdFx0XHRcdCdjbGFzcz1cImxpbmsgZGVwdGgtJyArIGluZGVudCArICdcIicgK1xyXG5cdFx0XHRcdFx0KCAodHlwZW9mIHRhcmdldCAhPT0gJ3VuZGVmaW5lZCcgJiYgdGFyZ2V0ICE9ICcnKSA/ICcgdGFyZ2V0PVwiJyArIHRhcmdldCArICdcIicgOiAnJykgK1xyXG5cdFx0XHRcdFx0KCAodHlwZW9mIGhyZWYgIT09ICd1bmRlZmluZWQnICYmIGhyZWYgIT0gJycpID8gJyBocmVmPVwiJyArIGhyZWYgKyAnXCInIDogJycpICtcclxuXHRcdFx0XHQnPicgK1xyXG5cdFx0XHRcdFx0JzxzcGFuIGNsYXNzPVwiaW5kZW50LScgKyBpbmRlbnQgKyAnXCI+PC9zcGFuPicgK1xyXG5cdFx0XHRcdFx0JHRoaXMudGV4dCgpICtcclxuXHRcdFx0XHQnPC9hPidcclxuXHRcdFx0KTtcclxuXHJcblx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gYi5qb2luKCcnKTtcclxuXHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogUGFuZWwtaWZ5IGFuIGVsZW1lbnQuXHJcblx0ICogQHBhcmFtIHtvYmplY3R9IHVzZXJDb25maWcgVXNlciBjb25maWcuXHJcblx0ICogQHJldHVybiB7alF1ZXJ5fSBqUXVlcnkgb2JqZWN0LlxyXG5cdCAqL1xyXG5cdCQuZm4ucGFuZWwgPSBmdW5jdGlvbih1c2VyQ29uZmlnKSB7XHJcblxyXG5cdFx0Ly8gTm8gZWxlbWVudHM/XHJcblx0XHRcdGlmICh0aGlzLmxlbmd0aCA9PSAwKVxyXG5cdFx0XHRcdHJldHVybiAkdGhpcztcclxuXHJcblx0XHQvLyBNdWx0aXBsZSBlbGVtZW50cz9cclxuXHRcdFx0aWYgKHRoaXMubGVuZ3RoID4gMSkge1xyXG5cclxuXHRcdFx0XHRmb3IgKHZhciBpPTA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKVxyXG5cdFx0XHRcdFx0JCh0aGlzW2ldKS5wYW5lbCh1c2VyQ29uZmlnKTtcclxuXHJcblx0XHRcdFx0cmV0dXJuICR0aGlzO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdC8vIFZhcnMuXHJcblx0XHRcdHZhclx0JHRoaXMgPSAkKHRoaXMpLFxyXG5cdFx0XHRcdCRib2R5ID0gJCgnYm9keScpLFxyXG5cdFx0XHRcdCR3aW5kb3cgPSAkKHdpbmRvdyksXHJcblx0XHRcdFx0aWQgPSAkdGhpcy5hdHRyKCdpZCcpLFxyXG5cdFx0XHRcdGNvbmZpZztcclxuXHJcblx0XHQvLyBDb25maWcuXHJcblx0XHRcdGNvbmZpZyA9ICQuZXh0ZW5kKHtcclxuXHJcblx0XHRcdFx0Ly8gRGVsYXkuXHJcblx0XHRcdFx0XHRkZWxheTogMCxcclxuXHJcblx0XHRcdFx0Ly8gSGlkZSBwYW5lbCBvbiBsaW5rIGNsaWNrLlxyXG5cdFx0XHRcdFx0aGlkZU9uQ2xpY2s6IGZhbHNlLFxyXG5cclxuXHRcdFx0XHQvLyBIaWRlIHBhbmVsIG9uIGVzY2FwZSBrZXlwcmVzcy5cclxuXHRcdFx0XHRcdGhpZGVPbkVzY2FwZTogZmFsc2UsXHJcblxyXG5cdFx0XHRcdC8vIEhpZGUgcGFuZWwgb24gc3dpcGUuXHJcblx0XHRcdFx0XHRoaWRlT25Td2lwZTogZmFsc2UsXHJcblxyXG5cdFx0XHRcdC8vIFJlc2V0IHNjcm9sbCBwb3NpdGlvbiBvbiBoaWRlLlxyXG5cdFx0XHRcdFx0cmVzZXRTY3JvbGw6IGZhbHNlLFxyXG5cclxuXHRcdFx0XHQvLyBSZXNldCBmb3JtcyBvbiBoaWRlLlxyXG5cdFx0XHRcdFx0cmVzZXRGb3JtczogZmFsc2UsXHJcblxyXG5cdFx0XHRcdC8vIFNpZGUgb2Ygdmlld3BvcnQgdGhlIHBhbmVsIHdpbGwgYXBwZWFyLlxyXG5cdFx0XHRcdFx0c2lkZTogbnVsbCxcclxuXHJcblx0XHRcdFx0Ly8gVGFyZ2V0IGVsZW1lbnQgZm9yIFwiY2xhc3NcIi5cclxuXHRcdFx0XHRcdHRhcmdldDogJHRoaXMsXHJcblxyXG5cdFx0XHRcdC8vIENsYXNzIHRvIHRvZ2dsZS5cclxuXHRcdFx0XHRcdHZpc2libGVDbGFzczogJ3Zpc2libGUnXHJcblxyXG5cdFx0XHR9LCB1c2VyQ29uZmlnKTtcclxuXHJcblx0XHRcdC8vIEV4cGFuZCBcInRhcmdldFwiIGlmIGl0J3Mgbm90IGEgalF1ZXJ5IG9iamVjdCBhbHJlYWR5LlxyXG5cdFx0XHRcdGlmICh0eXBlb2YgY29uZmlnLnRhcmdldCAhPSAnalF1ZXJ5JylcclxuXHRcdFx0XHRcdGNvbmZpZy50YXJnZXQgPSAkKGNvbmZpZy50YXJnZXQpO1xyXG5cclxuXHRcdC8vIFBhbmVsLlxyXG5cclxuXHRcdFx0Ly8gTWV0aG9kcy5cclxuXHRcdFx0XHQkdGhpcy5faGlkZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQWxyZWFkeSBoaWRkZW4/IEJhaWwuXHJcblx0XHRcdFx0XHRcdGlmICghY29uZmlnLnRhcmdldC5oYXNDbGFzcyhjb25maWcudmlzaWJsZUNsYXNzKSlcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0XHRcdFx0Ly8gSWYgYW4gZXZlbnQgd2FzIHByb3ZpZGVkLCBjYW5jZWwgaXQuXHJcblx0XHRcdFx0XHRcdGlmIChldmVudCkge1xyXG5cclxuXHRcdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIEhpZGUuXHJcblx0XHRcdFx0XHRcdGNvbmZpZy50YXJnZXQucmVtb3ZlQ2xhc3MoY29uZmlnLnZpc2libGVDbGFzcyk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gUG9zdC1oaWRlIHN0dWZmLlxyXG5cdFx0XHRcdFx0XHR3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gUmVzZXQgc2Nyb2xsIHBvc2l0aW9uLlxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvbmZpZy5yZXNldFNjcm9sbClcclxuXHRcdFx0XHRcdFx0XHRcdFx0JHRoaXMuc2Nyb2xsVG9wKDApO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBSZXNldCBmb3Jtcy5cclxuXHRcdFx0XHRcdFx0XHRcdGlmIChjb25maWcucmVzZXRGb3JtcylcclxuXHRcdFx0XHRcdFx0XHRcdFx0JHRoaXMuZmluZCgnZm9ybScpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5yZXNldCgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRcdH0sIGNvbmZpZy5kZWxheSk7XHJcblxyXG5cdFx0XHRcdH07XHJcblxyXG5cdFx0XHQvLyBWZW5kb3IgZml4ZXMuXHJcblx0XHRcdFx0JHRoaXNcclxuXHRcdFx0XHRcdC5jc3MoJy1tcy1vdmVyZmxvdy1zdHlsZScsICctbXMtYXV0b2hpZGluZy1zY3JvbGxiYXInKVxyXG5cdFx0XHRcdFx0LmNzcygnLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmcnLCAndG91Y2gnKTtcclxuXHJcblx0XHRcdC8vIEhpZGUgb24gY2xpY2suXHJcblx0XHRcdFx0aWYgKGNvbmZpZy5oaWRlT25DbGljaykge1xyXG5cclxuXHRcdFx0XHRcdCR0aGlzLmZpbmQoJ2EnKVxyXG5cdFx0XHRcdFx0XHQuY3NzKCctd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3InLCAncmdiYSgwLDAsMCwwKScpO1xyXG5cclxuXHRcdFx0XHRcdCR0aGlzXHJcblx0XHRcdFx0XHRcdC5vbignY2xpY2snLCAnYScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdHZhciAkYSA9ICQodGhpcyksXHJcblx0XHRcdFx0XHRcdFx0XHRocmVmID0gJGEuYXR0cignaHJlZicpLFxyXG5cdFx0XHRcdFx0XHRcdFx0dGFyZ2V0ID0gJGEuYXR0cigndGFyZ2V0Jyk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmICghaHJlZiB8fCBocmVmID09ICcjJyB8fCBocmVmID09ICcnIHx8IGhyZWYgPT0gJyMnICsgaWQpXHJcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vIENhbmNlbCBvcmlnaW5hbCBldmVudC5cclxuXHRcdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gSGlkZSBwYW5lbC5cclxuXHRcdFx0XHRcdFx0XHRcdCR0aGlzLl9oaWRlKCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vIFJlZGlyZWN0IHRvIGhyZWYuXHJcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0YXJnZXQgPT0gJ19ibGFuaycpXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0d2luZG93Lm9wZW4oaHJlZik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IGhyZWY7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0fSwgY29uZmlnLmRlbGF5ICsgMTApO1xyXG5cclxuXHRcdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEV2ZW50OiBUb3VjaCBzdHVmZi5cclxuXHRcdFx0XHQkdGhpcy5vbigndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0JHRoaXMudG91Y2hQb3NYID0gZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VYO1xyXG5cdFx0XHRcdFx0JHRoaXMudG91Y2hQb3NZID0gZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VZO1xyXG5cclxuXHRcdFx0XHR9KVxyXG5cclxuXHRcdFx0XHQkdGhpcy5vbigndG91Y2htb3ZlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHRcdFx0XHRpZiAoJHRoaXMudG91Y2hQb3NYID09PSBudWxsXHJcblx0XHRcdFx0XHR8fFx0JHRoaXMudG91Y2hQb3NZID09PSBudWxsKVxyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0XHRcdFx0dmFyXHRkaWZmWCA9ICR0aGlzLnRvdWNoUG9zWCAtIGV2ZW50Lm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXS5wYWdlWCxcclxuXHRcdFx0XHRcdFx0ZGlmZlkgPSAkdGhpcy50b3VjaFBvc1kgLSBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVksXHJcblx0XHRcdFx0XHRcdHRoID0gJHRoaXMub3V0ZXJIZWlnaHQoKSxcclxuXHRcdFx0XHRcdFx0dHMgPSAoJHRoaXMuZ2V0KDApLnNjcm9sbEhlaWdodCAtICR0aGlzLnNjcm9sbFRvcCgpKTtcclxuXHJcblx0XHRcdFx0XHQvLyBIaWRlIG9uIHN3aXBlP1xyXG5cdFx0XHRcdFx0XHRpZiAoY29uZmlnLmhpZGVPblN3aXBlKSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdHZhciByZXN1bHQgPSBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdGJvdW5kYXJ5ID0gMjAsXHJcblx0XHRcdFx0XHRcdFx0XHRkZWx0YSA9IDUwO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGNvbmZpZy5zaWRlKSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAnbGVmdCc6XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IChkaWZmWSA8IGJvdW5kYXJ5ICYmIGRpZmZZID4gKC0xICogYm91bmRhcnkpKSAmJiAoZGlmZlggPiBkZWx0YSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ3JpZ2h0JzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0ID0gKGRpZmZZIDwgYm91bmRhcnkgJiYgZGlmZlkgPiAoLTEgKiBib3VuZGFyeSkpICYmIChkaWZmWCA8ICgtMSAqIGRlbHRhKSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ3RvcCc6XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IChkaWZmWCA8IGJvdW5kYXJ5ICYmIGRpZmZYID4gKC0xICogYm91bmRhcnkpKSAmJiAoZGlmZlkgPiBkZWx0YSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ2JvdHRvbSc6XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IChkaWZmWCA8IGJvdW5kYXJ5ICYmIGRpZmZYID4gKC0xICogYm91bmRhcnkpKSAmJiAoZGlmZlkgPCAoLTEgKiBkZWx0YSkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRpZiAocmVzdWx0KSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0JHRoaXMudG91Y2hQb3NYID0gbnVsbDtcclxuXHRcdFx0XHRcdFx0XHRcdCR0aGlzLnRvdWNoUG9zWSA9IG51bGw7XHJcblx0XHRcdFx0XHRcdFx0XHQkdGhpcy5faGlkZSgpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFByZXZlbnQgdmVydGljYWwgc2Nyb2xsaW5nIHBhc3QgdGhlIHRvcCBvciBib3R0b20uXHJcblx0XHRcdFx0XHRcdGlmICgoJHRoaXMuc2Nyb2xsVG9wKCkgPCAwICYmIGRpZmZZIDwgMClcclxuXHRcdFx0XHRcdFx0fHwgKHRzID4gKHRoIC0gMikgJiYgdHMgPCAodGggKyAyKSAmJiBkaWZmWSA+IDApKSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gRXZlbnQ6IFByZXZlbnQgY2VydGFpbiBldmVudHMgaW5zaWRlIHRoZSBwYW5lbCBmcm9tIGJ1YmJsaW5nLlxyXG5cdFx0XHRcdCR0aGlzLm9uKCdjbGljayB0b3VjaGVuZCB0b3VjaHN0YXJ0IHRvdWNobW92ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEV2ZW50OiBIaWRlIHBhbmVsIGlmIGEgY2hpbGQgYW5jaG9yIHRhZyBwb2ludGluZyB0byBpdHMgSUQgaXMgY2xpY2tlZC5cclxuXHRcdFx0XHQkdGhpcy5vbignY2xpY2snLCAnYVtocmVmPVwiIycgKyBpZCArICdcIl0nLCBmdW5jdGlvbihldmVudCkge1xyXG5cclxuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0XHRcdFx0XHRjb25maWcudGFyZ2V0LnJlbW92ZUNsYXNzKGNvbmZpZy52aXNpYmxlQ2xhc3MpO1xyXG5cclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHQvLyBCb2R5LlxyXG5cclxuXHRcdFx0Ly8gRXZlbnQ6IEhpZGUgcGFuZWwgb24gYm9keSBjbGljay90YXAuXHJcblx0XHRcdFx0JGJvZHkub24oJ2NsaWNrIHRvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0XHRcdCR0aGlzLl9oaWRlKGV2ZW50KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEV2ZW50OiBUb2dnbGUuXHJcblx0XHRcdFx0JGJvZHkub24oJ2NsaWNrJywgJ2FbaHJlZj1cIiMnICsgaWQgKyAnXCJdJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdFx0XHRcdFx0Y29uZmlnLnRhcmdldC50b2dnbGVDbGFzcyhjb25maWcudmlzaWJsZUNsYXNzKTtcclxuXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0Ly8gV2luZG93LlxyXG5cclxuXHRcdFx0Ly8gRXZlbnQ6IEhpZGUgb24gRVNDLlxyXG5cdFx0XHRcdGlmIChjb25maWcuaGlkZU9uRXNjYXBlKVxyXG5cdFx0XHRcdFx0JHdpbmRvdy5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0XHRpZiAoZXZlbnQua2V5Q29kZSA9PSAyNylcclxuXHRcdFx0XHRcdFx0XHQkdGhpcy5faGlkZShldmVudCk7XHJcblxyXG5cdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuICR0aGlzO1xyXG5cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBBcHBseSBcInBsYWNlaG9sZGVyXCIgYXR0cmlidXRlIHBvbHlmaWxsIHRvIG9uZSBvciBtb3JlIGZvcm1zLlxyXG5cdCAqIEByZXR1cm4ge2pRdWVyeX0galF1ZXJ5IG9iamVjdC5cclxuXHQgKi9cclxuXHQkLmZuLnBsYWNlaG9sZGVyID0gZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0Ly8gQnJvd3NlciBuYXRpdmVseSBzdXBwb3J0cyBwbGFjZWhvbGRlcnM/IEJhaWwuXHJcblx0XHRcdGlmICh0eXBlb2YgKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykpLnBsYWNlaG9sZGVyICE9ICd1bmRlZmluZWQnKVxyXG5cdFx0XHRcdHJldHVybiAkKHRoaXMpO1xyXG5cclxuXHRcdC8vIE5vIGVsZW1lbnRzP1xyXG5cdFx0XHRpZiAodGhpcy5sZW5ndGggPT0gMClcclxuXHRcdFx0XHRyZXR1cm4gJHRoaXM7XHJcblxyXG5cdFx0Ly8gTXVsdGlwbGUgZWxlbWVudHM/XHJcblx0XHRcdGlmICh0aGlzLmxlbmd0aCA+IDEpIHtcclxuXHJcblx0XHRcdFx0Zm9yICh2YXIgaT0wOyBpIDwgdGhpcy5sZW5ndGg7IGkrKylcclxuXHRcdFx0XHRcdCQodGhpc1tpXSkucGxhY2Vob2xkZXIoKTtcclxuXHJcblx0XHRcdFx0cmV0dXJuICR0aGlzO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdC8vIFZhcnMuXHJcblx0XHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblxyXG5cdFx0Ly8gVGV4dCwgVGV4dEFyZWEuXHJcblx0XHRcdCR0aGlzLmZpbmQoJ2lucHV0W3R5cGU9dGV4dF0sdGV4dGFyZWEnKVxyXG5cdFx0XHRcdC5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdFx0XHRcdHZhciBpID0gJCh0aGlzKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoaS52YWwoKSA9PSAnJ1xyXG5cdFx0XHRcdFx0fHwgIGkudmFsKCkgPT0gaS5hdHRyKCdwbGFjZWhvbGRlcicpKVxyXG5cdFx0XHRcdFx0XHRpXHJcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKCdwb2x5ZmlsbC1wbGFjZWhvbGRlcicpXHJcblx0XHRcdFx0XHRcdFx0LnZhbChpLmF0dHIoJ3BsYWNlaG9sZGVyJykpO1xyXG5cclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5vbignYmx1cicsIGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdFx0XHRcdHZhciBpID0gJCh0aGlzKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoaS5hdHRyKCduYW1lJykubWF0Y2goLy1wb2x5ZmlsbC1maWVsZCQvKSlcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdFx0XHRcdGlmIChpLnZhbCgpID09ICcnKVxyXG5cdFx0XHRcdFx0XHRpXHJcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKCdwb2x5ZmlsbC1wbGFjZWhvbGRlcicpXHJcblx0XHRcdFx0XHRcdFx0LnZhbChpLmF0dHIoJ3BsYWNlaG9sZGVyJykpO1xyXG5cclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdFx0XHR2YXIgaSA9ICQodGhpcyk7XHJcblxyXG5cdFx0XHRcdFx0aWYgKGkuYXR0cignbmFtZScpLm1hdGNoKC8tcG9seWZpbGwtZmllbGQkLykpXHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdFx0XHRpZiAoaS52YWwoKSA9PSBpLmF0dHIoJ3BsYWNlaG9sZGVyJykpXHJcblx0XHRcdFx0XHRcdGlcclxuXHRcdFx0XHRcdFx0XHQucmVtb3ZlQ2xhc3MoJ3BvbHlmaWxsLXBsYWNlaG9sZGVyJylcclxuXHRcdFx0XHRcdFx0XHQudmFsKCcnKTtcclxuXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0Ly8gUGFzc3dvcmQuXHJcblx0XHRcdCR0aGlzLmZpbmQoJ2lucHV0W3R5cGU9cGFzc3dvcmRdJylcclxuXHRcdFx0XHQuZWFjaChmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdFx0XHR2YXIgaSA9ICQodGhpcyk7XHJcblx0XHRcdFx0XHR2YXIgeCA9ICQoXHJcblx0XHRcdFx0XHRcdFx0XHQkKCc8ZGl2PicpXHJcblx0XHRcdFx0XHRcdFx0XHRcdC5hcHBlbmQoaS5jbG9uZSgpKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQucmVtb3ZlKClcclxuXHRcdFx0XHRcdFx0XHRcdFx0Lmh0bWwoKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvdHlwZT1cInBhc3N3b3JkXCIvaSwgJ3R5cGU9XCJ0ZXh0XCInKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvdHlwZT1wYXNzd29yZC9pLCAndHlwZT10ZXh0JylcclxuXHRcdFx0XHRcdCk7XHJcblxyXG5cdFx0XHRcdFx0aWYgKGkuYXR0cignaWQnKSAhPSAnJylcclxuXHRcdFx0XHRcdFx0eC5hdHRyKCdpZCcsIGkuYXR0cignaWQnKSArICctcG9seWZpbGwtZmllbGQnKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoaS5hdHRyKCduYW1lJykgIT0gJycpXHJcblx0XHRcdFx0XHRcdHguYXR0cignbmFtZScsIGkuYXR0cignbmFtZScpICsgJy1wb2x5ZmlsbC1maWVsZCcpO1xyXG5cclxuXHRcdFx0XHRcdHguYWRkQ2xhc3MoJ3BvbHlmaWxsLXBsYWNlaG9sZGVyJylcclxuXHRcdFx0XHRcdFx0LnZhbCh4LmF0dHIoJ3BsYWNlaG9sZGVyJykpLmluc2VydEFmdGVyKGkpO1xyXG5cclxuXHRcdFx0XHRcdGlmIChpLnZhbCgpID09ICcnKVxyXG5cdFx0XHRcdFx0XHRpLmhpZGUoKTtcclxuXHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0eC5oaWRlKCk7XHJcblxyXG5cdFx0XHRcdFx0aVxyXG5cdFx0XHRcdFx0XHQub24oJ2JsdXInLCBmdW5jdGlvbihldmVudCkge1xyXG5cclxuXHRcdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHR2YXIgeCA9IGkucGFyZW50KCkuZmluZCgnaW5wdXRbbmFtZT0nICsgaS5hdHRyKCduYW1lJykgKyAnLXBvbHlmaWxsLWZpZWxkXScpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZiAoaS52YWwoKSA9PSAnJykge1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGkuaGlkZSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0eC5zaG93KCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdHhcclxuXHRcdFx0XHRcdFx0Lm9uKCdmb2N1cycsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdHZhciBpID0geC5wYXJlbnQoKS5maW5kKCdpbnB1dFtuYW1lPScgKyB4LmF0dHIoJ25hbWUnKS5yZXBsYWNlKCctcG9seWZpbGwtZmllbGQnLCAnJykgKyAnXScpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHR4LmhpZGUoKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0aVxyXG5cdFx0XHRcdFx0XHRcdFx0LnNob3coKVxyXG5cdFx0XHRcdFx0XHRcdFx0LmZvY3VzKCk7XHJcblxyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0XHQub24oJ2tleXByZXNzJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHRcdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0XHRcdFx0XHR4LnZhbCgnJyk7XHJcblxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0Ly8gRXZlbnRzLlxyXG5cdFx0XHQkdGhpc1xyXG5cdFx0XHRcdC5vbignc3VibWl0JywgZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0XHRcdFx0JHRoaXMuZmluZCgnaW5wdXRbdHlwZT10ZXh0XSxpbnB1dFt0eXBlPXBhc3N3b3JkXSx0ZXh0YXJlYScpXHJcblx0XHRcdFx0XHRcdC5lYWNoKGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdHZhciBpID0gJCh0aGlzKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0aWYgKGkuYXR0cignbmFtZScpLm1hdGNoKC8tcG9seWZpbGwtZmllbGQkLykpXHJcblx0XHRcdFx0XHRcdFx0XHRpLmF0dHIoJ25hbWUnLCAnJyk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmIChpLnZhbCgpID09IGkuYXR0cigncGxhY2Vob2xkZXInKSkge1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGkucmVtb3ZlQ2xhc3MoJ3BvbHlmaWxsLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRpLnZhbCgnJyk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5vbigncmVzZXQnLCBmdW5jdGlvbihldmVudCkge1xyXG5cclxuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0XHRcdFx0JHRoaXMuZmluZCgnc2VsZWN0JylcclxuXHRcdFx0XHRcdFx0LnZhbCgkKCdvcHRpb246Zmlyc3QnKS52YWwoKSk7XHJcblxyXG5cdFx0XHRcdFx0JHRoaXMuZmluZCgnaW5wdXQsdGV4dGFyZWEnKVxyXG5cdFx0XHRcdFx0XHQuZWFjaChmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdFx0XHRcdFx0dmFyIGkgPSAkKHRoaXMpLFxyXG5cdFx0XHRcdFx0XHRcdFx0eDtcclxuXHJcblx0XHRcdFx0XHRcdFx0aS5yZW1vdmVDbGFzcygncG9seWZpbGwtcGxhY2Vob2xkZXInKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0c3dpdGNoICh0aGlzLnR5cGUpIHtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRjYXNlICdzdWJtaXQnOlxyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAncmVzZXQnOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRjYXNlICdwYXNzd29yZCc6XHJcblx0XHRcdFx0XHRcdFx0XHRcdGkudmFsKGkuYXR0cignZGVmYXVsdFZhbHVlJykpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0eCA9IGkucGFyZW50KCkuZmluZCgnaW5wdXRbbmFtZT0nICsgaS5hdHRyKCduYW1lJykgKyAnLXBvbHlmaWxsLWZpZWxkXScpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGkudmFsKCkgPT0gJycpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpLmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR4LnNob3coKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpLnNob3coKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR4LmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAnY2hlY2tib3gnOlxyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAncmFkaW8nOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpLmF0dHIoJ2NoZWNrZWQnLCBpLmF0dHIoJ2RlZmF1bHRWYWx1ZScpKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAndGV4dCc6XHJcblx0XHRcdFx0XHRcdFx0XHRjYXNlICd0ZXh0YXJlYSc6XHJcblx0XHRcdFx0XHRcdFx0XHRcdGkudmFsKGkuYXR0cignZGVmYXVsdFZhbHVlJykpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGkudmFsKCkgPT0gJycpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpLmFkZENsYXNzKCdwb2x5ZmlsbC1wbGFjZWhvbGRlcicpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGkudmFsKGkuYXR0cigncGxhY2Vob2xkZXInKSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGRlZmF1bHQ6XHJcblx0XHRcdFx0XHRcdFx0XHRcdGkudmFsKGkuYXR0cignZGVmYXVsdFZhbHVlJykpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuICR0aGlzO1xyXG5cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBNb3ZlcyBlbGVtZW50cyB0by9mcm9tIHRoZSBmaXJzdCBwb3NpdGlvbnMgb2YgdGhlaXIgcmVzcGVjdGl2ZSBwYXJlbnRzLlxyXG5cdCAqIEBwYXJhbSB7alF1ZXJ5fSAkZWxlbWVudHMgRWxlbWVudHMgKG9yIHNlbGVjdG9yKSB0byBtb3ZlLlxyXG5cdCAqIEBwYXJhbSB7Ym9vbH0gY29uZGl0aW9uIElmIHRydWUsIG1vdmVzIGVsZW1lbnRzIHRvIHRoZSB0b3AuIE90aGVyd2lzZSwgbW92ZXMgZWxlbWVudHMgYmFjayB0byB0aGVpciBvcmlnaW5hbCBsb2NhdGlvbnMuXHJcblx0ICovXHJcblx0JC5wcmlvcml0aXplID0gZnVuY3Rpb24oJGVsZW1lbnRzLCBjb25kaXRpb24pIHtcclxuXHJcblx0XHR2YXIga2V5ID0gJ19fcHJpb3JpdGl6ZSc7XHJcblxyXG5cdFx0Ly8gRXhwYW5kICRlbGVtZW50cyBpZiBpdCdzIG5vdCBhbHJlYWR5IGEgalF1ZXJ5IG9iamVjdC5cclxuXHRcdFx0aWYgKHR5cGVvZiAkZWxlbWVudHMgIT0gJ2pRdWVyeScpXHJcblx0XHRcdFx0JGVsZW1lbnRzID0gJCgkZWxlbWVudHMpO1xyXG5cclxuXHRcdC8vIFN0ZXAgdGhyb3VnaCBlbGVtZW50cy5cclxuXHRcdFx0JGVsZW1lbnRzLmVhY2goZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0XHRcdHZhclx0JGUgPSAkKHRoaXMpLCAkcCxcclxuXHRcdFx0XHRcdCRwYXJlbnQgPSAkZS5wYXJlbnQoKTtcclxuXHJcblx0XHRcdFx0Ly8gTm8gcGFyZW50PyBCYWlsLlxyXG5cdFx0XHRcdFx0aWYgKCRwYXJlbnQubGVuZ3RoID09IDApXHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdFx0Ly8gTm90IG1vdmVkPyBNb3ZlIGl0LlxyXG5cdFx0XHRcdFx0aWYgKCEkZS5kYXRhKGtleSkpIHtcclxuXHJcblx0XHRcdFx0XHRcdC8vIENvbmRpdGlvbiBpcyBmYWxzZT8gQmFpbC5cclxuXHRcdFx0XHRcdFx0XHRpZiAoIWNvbmRpdGlvbilcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdFx0XHRcdC8vIEdldCBwbGFjZWhvbGRlciAod2hpY2ggd2lsbCBzZXJ2ZSBhcyBvdXIgcG9pbnQgb2YgcmVmZXJlbmNlIGZvciB3aGVuIHRoaXMgZWxlbWVudCBuZWVkcyB0byBtb3ZlIGJhY2spLlxyXG5cdFx0XHRcdFx0XHRcdCRwID0gJGUucHJldigpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBDb3VsZG4ndCBmaW5kIGFueXRoaW5nPyBNZWFucyB0aGlzIGVsZW1lbnQncyBhbHJlYWR5IGF0IHRoZSB0b3AsIHNvIGJhaWwuXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoJHAubGVuZ3RoID09IDApXHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdFx0XHRcdC8vIE1vdmUgZWxlbWVudCB0byB0b3Agb2YgcGFyZW50LlxyXG5cdFx0XHRcdFx0XHRcdCRlLnByZXBlbmRUbygkcGFyZW50KTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIE1hcmsgZWxlbWVudCBhcyBtb3ZlZC5cclxuXHRcdFx0XHRcdFx0XHQkZS5kYXRhKGtleSwgJHApO1xyXG5cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gTW92ZWQgYWxyZWFkeT9cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gQ29uZGl0aW9uIGlzIHRydWU/IEJhaWwuXHJcblx0XHRcdFx0XHRcdFx0aWYgKGNvbmRpdGlvbilcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdFx0XHRcdCRwID0gJGUuZGF0YShrZXkpO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gTW92ZSBlbGVtZW50IGJhY2sgdG8gaXRzIG9yaWdpbmFsIGxvY2F0aW9uICh1c2luZyBvdXIgcGxhY2Vob2xkZXIpLlxyXG5cdFx0XHRcdFx0XHRcdCRlLmluc2VydEFmdGVyKCRwKTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIFVubWFyayBlbGVtZW50IGFzIG1vdmVkLlxyXG5cdFx0XHRcdFx0XHRcdCRlLnJlbW92ZURhdGEoa2V5KTtcclxuXHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9KTtcclxuXHJcblx0fTtcclxuXHJcbn0pKGpRdWVyeSk7Il19